package models.vulnerability;

import com.google.gson.JsonObject;
import models.attachments.AttachmentArchive;

import java.util.ArrayList;

public class Vulnerability {

    private int projectId;
    private int assetId;
    private int vulnerabilityTemplateId;

    private String title;
    private String impact;
    private String probability;

    private String description;
    private String solution;
    private String summary;
    private String impactResume;
    private boolean notification;

    private String webProtocol;
    private String webMethod;
    private String webUrl;
    private Integer webPort;
    private String webParameters;
    private String webSteps;
    private String webRequest;
    private String webResponse;
    private Boolean invaded;
    private String invadedEnvironmentDescription;
    private ArrayList<AttachmentArchive> attachmentArchives;
    private String clienteMutationId;



    public Vulnerability(){

    }

    public Vulnerability(int projectId, int vulnerabilityTemplateId, String impact, String probability, Boolean invaded,
                 String invadedDescription, String description, String impactResume, String webProtocol,
                 String webMethod, String webUrl, String webParameters,
                 String webSteps, String webRequest, String webResponse) {

        this.projectId = projectId;
        this.vulnerabilityTemplateId = vulnerabilityTemplateId;
        this.impact = impact;
        this.probability = probability;
        this.description = description;
        this.impactResume = impactResume;
        this.webProtocol = webProtocol;
        this.webMethod = webMethod;
        this.webUrl = webUrl;
        this.webParameters = webParameters;
        this.webSteps = webSteps;
        this.webRequest = webRequest;
        this.webResponse = webResponse;
        this.invaded = invaded;
        this.invadedEnvironmentDescription = invadedDescription;
        this.attachmentArchives = new ArrayList<>();
    }

    public void setProjectId(int projectId) {
        this.projectId = projectId;
    }

    public void setAssetId(int assetId) {
        this.assetId = assetId;
    }

    public void setVulnerabilityTemplateId(int vulnerabilityTemplateId) {
        this.vulnerabilityTemplateId = vulnerabilityTemplateId;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public void setImpact(String impact) {
        this.impact = impact;
    }

    public void setProbability(String probability) {
        this.probability = probability;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public void setSolution(String solution) {
        this.solution = solution;
    }

    public void setSummary(String summary) {
        this.summary = summary;
    }

    public void setImpactResume(String impactResume) {
        this.impactResume = impactResume;
    }

    public void setWebProtocol(String webProtocol) {
        this.webProtocol = webProtocol;
    }

    public void setWebMethod(String webMethod) {
        this.webMethod = webMethod;
    }

    public void setWebUrl(String webUrl) {
        this.webUrl = webUrl;
    }

    public void setWebPort(Integer webPort) {
        this.webPort = webPort;
    }

    public void setWebParameters(String webParameters) {
        this.webParameters = webParameters;
    }

    public void setWebSteps(String webSteps) {
        this.webSteps = webSteps;
    }

    public void setWebRequest(String webRequest) {
        this.webRequest = webRequest;
    }

    public void setWebResponse(String webResponse) {
        this.webResponse = webResponse;
    }


    public void setInvaded(Boolean invaded) {
        this.invaded = invaded;
    }

    public void setInvadedEnvironmentDescription(String invadedEnvironmentDescription) {
        this.invadedEnvironmentDescription = invadedEnvironmentDescription;
    }

    public void setAttachments(ArrayList<AttachmentArchive> attachmentArchives) {
        this.attachmentArchives = attachmentArchives;
    }

    public String getNullByAttachmentsListSize(){
        StringBuilder stringBuilder = new StringBuilder();
        for (int i = 0; i < this.attachmentArchives.size(); i++) {
            stringBuilder.append("null");
            if(i != this.attachmentArchives.size()-1) {
                stringBuilder.append(",");
            }
        }
        return stringBuilder.toString();
    }


    public void setNotification(boolean notification) {
        this.notification = notification;
    }



    public int getProjectId() {
        return projectId;
    }

    public int getAssetId() {
        return assetId;
    }

    public int getVulnerabilityTemplateId() {
        return vulnerabilityTemplateId;
    }

    public String getTitle() {
        return title;
    }

    public String getImpact() {
        return impact;
    }

    public String getProbability() {
        return probability;
    }

    public String getDescription() {
        return description;
    }

    public String getSolution() {
        return solution;
    }

    public String getSummary() {
        return summary;
    }

    public String getImpactResume() {
        return impactResume;
    }

    public boolean isNotification() {
        return notification;
    }

    public Boolean getInvaded() {
        return invaded;
    }

    public String getWebProtocol() {
        return webProtocol;
    }

    public String getWebMethod() {
        return webMethod;
    }

    public String getWebUrl() {
        return webUrl;
    }

    public Integer getWebPort() {
        return webPort;
    }

    public String getWebParameters() {
        return webParameters;
    }

    public String getWebSteps() {
        return webSteps;
    }

    public String getWebRequest() {
        return webRequest;
    }

    public String getWebResponse() {
        return webResponse;
    }

    public String getInvadedEnvironmentDescription() {
        return invadedEnvironmentDescription;
    }

    public ArrayList<AttachmentArchive> getAttachments() {
        return attachmentArchives;
    }

    public String getClienteMutationId() {
        return clienteMutationId;
    }

    @Override
    public String toString() {
        return "Vulnerability{" +
                "project_id=" + projectId +
                ", asset_id=" + assetId +
                ", vulnerability_model_id=" + vulnerabilityTemplateId +
                ", title='" + title + '\'' +
                ", impact='" + impact + '\'' +
                ", probability='" + probability + '\'' +
                ", client_impact='" + description + '\'' +
                ", solution='" + solution + '\'' +
                ", summary='" + summary + '\'' +
                ", impact_resume='" + impactResume + '\'' +
                ", web_protocol='" + webProtocol + '\'' +
                ", web_method='" + webMethod + '\'' +
                ", web_url='" + webUrl + '\'' +
                ", web_parameters='" + webParameters + '\'' +
                ", web_steps='" + webSteps + '\'' +
                ", web_request='" + webRequest + '\'' +
                ", web_response='" + webResponse + '\'' +
                ", invaded=" + invaded +
                ", invaded_environment_description='" + invadedEnvironmentDescription + '\'' +
                '}';
    }


    public JsonObject toJsonObject() {

        JsonObject toReturn = new JsonObject();
        toReturn.addProperty("projectId", this.projectId);
        toReturn.addProperty("assetId", this.assetId);
        toReturn.addProperty("vulnerabilityTemplateId", this.vulnerabilityTemplateId);
        toReturn.addProperty("title", this.title);
        toReturn.addProperty("impact", this.impact);
        toReturn.addProperty("probability", this.probability);
        toReturn.addProperty("description", this.description);
        toReturn.addProperty("solution", this.solution);
        toReturn.addProperty("summary", this.summary);
        toReturn.addProperty("impactResume", this.impactResume);
        toReturn.addProperty("webProtocol", this.webProtocol);
        toReturn.addProperty("webMethod", this.webMethod);
        toReturn.addProperty("webUrl", this.webUrl);
        toReturn.addProperty("webParameters", this.webParameters);
        toReturn.addProperty("webSteps", this.webSteps);
        toReturn.addProperty("webRequest", this.webRequest);
        toReturn.addProperty("webResponse", this.webResponse);
        if(this.invaded){
            toReturn.addProperty("invaded", true);
            toReturn.addProperty("invadedEnvironmentDescription", this.invadedEnvironmentDescription);
        }else{
            toReturn.addProperty("invaded", false);
        }


        return toReturn;
    }
}
